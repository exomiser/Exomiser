/*
 * The Exomiser - A tool to annotate and prioritize genomic variants
 *
 * Copyright (c) 2016-2019 Queen Mary University of London.
 * Copyright (c) 2012-2016 Charité Universitätsmedizin Berlin and Genome Research Ltd.
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

package org.monarchinitiative.exomiser.data.genome.model.parsers;

import org.junit.jupiter.api.Nested;
import org.junit.jupiter.api.Test;
import org.monarchinitiative.exomiser.core.proto.AlleleData;
import org.monarchinitiative.exomiser.data.genome.model.Allele;

import java.util.List;

import static org.junit.jupiter.api.Assertions.assertThrows;
import static org.monarchinitiative.exomiser.core.proto.AlleleProto.FrequencySource.*;

/**
 * @author Jules Jacobsen <j.jacobsen@qmul.ac.uk>
 */
public class Gnomad2ExomeAlleleParserTest {

    @Nested
    class GnomadV2_0_FormatTest extends AbstractAlleleParserTester<GnomadAlleleParser> {

        @Override
        public GnomadAlleleParser newInstance() {
            return new GnomadExomeParser(GnomadPopulationKey.GNOMAD_V2_0_EXOMES);
        }

        private static class GnomadExomeParser extends GnomadAlleleParser {

            public GnomadExomeParser(List<GnomadPopulationKey> populationKeys) {
                super(populationKeys);
            }
        }

        @Test
        public void parseLineFailAcSnp() throws Exception {
            String line = "1\t139019\t.\tG\tC\t2965.40\tAC0\tAC=0;AF=0.00000e+00;AN=132342;BaseQRankSum=-1.98000e-01;ClippingRankSum=9.22000e-01;DP=7253058;FS=0.00000e+00;InbreedingCoeff=-8.30000e-03;MQ=4.63500e+01;MQRankSum=1.98000e-01;QD=3.63000e+00;ReadPosRankSum=3.58000e-01;SOR=6.43000e-01;VQSLOD=-1.10200e-01;VQSR_culprit=QD;VQSR_NEGATIVE_TRAIN_SITE;GQ_HIST_ALT=0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|1;DP_HIST_ALT=0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0;AB_HIST_ALT=0|0|0|1|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0;GQ_HIST_ALL=3189|1641|421|585|445|187|319|296|143|243|191|92|306|26|193|63|208|24|205|63825;DP_HIST_ALL=5211|1205|757|527|486|345|5343|21021|10849|3044|1126|884|949|938|1030|1068|1029|1069|1088|1328;AB_HIST_ALL=0|0|0|1|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0;AC_AFR=0;AC_AMR=0;AC_ASJ=0;AC_EAS=0;AC_FIN=0;AC_NFE=0;AC_OTH=0;AC_SAS=0;AC_Male=0;AC_Female=0;AN_AFR=6184;AN_AMR=23686;AN_ASJ=7998;AN_EAS=9934;AN_FIN=6008;AN_NFE=52508;AN_OTH=3638;AN_SAS=22386;AN_Male=72368;AN_Female=59974;AF_AFR=0.00000e+00;AF_AMR=0.00000e+00;AF_ASJ=0.00000e+00;AF_EAS=0.00000e+00;AF_FIN=0.00000e+00;AF_NFE=0.00000e+00;AF_OTH=0.00000e+00;AF_SAS=0.00000e+00;AF_Male=0.00000e+00;AF_Female=0.00000e+00;GC_AFR=3092,0,0;GC_AMR=11843,0,0;GC_ASJ=3999,0,0;GC_EAS=4967,0,0;GC_FIN=3004,0,0;GC_NFE=26254,0,0;GC_OTH=1819,0,0;GC_SAS=11193,0,0;GC_Male=36184,0,0;GC_Female=29987,0,0;AC_raw=1;AN_raw=145204;AF_raw=6.88686e-06;GC_raw=72601,1,0;GC=66171,0,0;Hom_AFR=0;Hom_AMR=0;Hom_ASJ=0;Hom_EAS=0;Hom_FIN=0;Hom_NFE=0;Hom_OTH=0;Hom_SAS=0;Hom_Male=0;Hom_Female=0;Hom_raw=0;Hom=0;POPMAX=.;AC_POPMAX=.;AN_POPMAX=.;AF_POPMAX=.;DP_MEDIAN=710;DREF_MEDIAN=6.30957e-174;GQ_MEDIAN=99;AB_MEDIAN=1.67606e-01;AS_RF=1.54603e-01;AS_FilterStatus=AC0";

            assertParseLineEquals(line, List.of());
        }

        @Test
        public void parseLinePassSnp() throws Exception {
            String line = "1\t139020\t.\tT\tC\t1976.24\tPASS\tAC=1;AF=7.55504e-06;AN=132362;BaseQRankSum=3.81000e+00;ClippingRankSum=8.56000e-01;DP=7254150;FS=2.19900e+00;InbreedingCoeff=-7.80000e-03;MQ=4.70800e+01;MQRankSum=1.38000e+00;QD=7.32000e+00;ReadPosRankSum=1.52000e+00;SOR=8.48000e-01;VQSLOD=-8.14000e-01;VQSR_culprit=QD;VQSR_NEGATIVE_TRAIN_SITE;GQ_HIST_ALT=0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|1;DP_HIST_ALT=0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0;AB_HIST_ALT=0|0|0|0|0|0|1|0|0|0|0|0|0|0|0|0|0|0|0|0;GQ_HIST_ALL=3203|1636|438|584|447|186|305|298|142|231|199|103|305|32|193|59|205|27|208|63837;DP_HIST_ALL=5227|1208|754|526|484|345|5354|21034|10848|3044|1125|884|949|938|1030|1068|1029|1069|1088|1328;AB_HIST_ALL=0|0|0|0|0|0|1|0|0|0|0|0|0|0|0|0|0|0|0|0;AC_AFR=0;AC_AMR=0;AC_ASJ=0;AC_EAS=0;AC_FIN=0;AC_NFE=0;AC_OTH=0;AC_SAS=1;AC_Male=1;AC_Female=0;AN_AFR=6182;AN_AMR=23682;AN_ASJ=7998;AN_EAS=9936;AN_FIN=6012;AN_NFE=52528;AN_OTH=3638;AN_SAS=22386;AN_Male=72380;AN_Female=59982;AF_AFR=0.00000e+00;AF_AMR=0.00000e+00;AF_ASJ=0.00000e+00;AF_EAS=0.00000e+00;AF_FIN=0.00000e+00;AF_NFE=0.00000e+00;AF_OTH=0.00000e+00;AF_SAS=4.46708e-05;AF_Male=1.38160e-05;AF_Female=0.00000e+00;GC_AFR=3091,0,0;GC_AMR=11841,0,0;GC_ASJ=3999,0,0;GC_EAS=4968,0,0;GC_FIN=3006,0,0;GC_NFE=26264,0,0;GC_OTH=1819,0,0;GC_SAS=11192,1,0;GC_Male=36189,1,0;GC_Female=29991,0,0;AC_raw=1;AN_raw=145276;AF_raw=6.88345e-06;GC_raw=72637,1,0;GC=66180,1,0;Hom_AFR=0;Hom_AMR=0;Hom_ASJ=0;Hom_EAS=0;Hom_FIN=0;Hom_NFE=0;Hom_OTH=0;Hom_SAS=0;Hom_Male=0;Hom_Female=0;Hom_raw=0;Hom=0;POPMAX=SAS;AC_POPMAX=1;AN_POPMAX=22386;AF_POPMAX=4.46708e-05;DP_MEDIAN=264;DREF_MEDIAN=6.30957e-205;GQ_MEDIAN=99;AB_MEDIAN=3.10606e-01;AS_RF=2.26895e-01;AS_FilterStatus=PASS";

            Allele expected = new Allele(1, 139020, "T", "C");
            // AC_AFR=0;AN_AFR=6182;
            // AC_AMR=0;AN_AMR=23682;
            // AC_ASJ=0;AN_ASJ=7998;
            // AC_EAS=0;AN_EAS=9936;
            // AC_FIN=0;AN_FIN=6012;
            // AC_NFE=0;AN_NFE=52528;
            // AC_OTH=0;AN_OTH=3638;
            // AC_SAS=1;AN_SAS=22386
            expected.addFrequency(AlleleData.frequencyOf(GNOMAD_E_SAS, 1, 22386));

            assertParseLineEquals(line, List.of(expected));
        }
    }

    @Nested
    class GnomadV2_1_FormatTest extends AbstractAlleleParserTester<Gnomad2ExomeAlleleParser> {

        @Override
        public Gnomad2ExomeAlleleParser newInstance() {
            return new Gnomad2ExomeAlleleParser();
        }

        @Test
        void v2_1format() {
            // 1-17484-G-A
            String line = "1\t17484\trs753281850\tG\tA\t412189.47\tPASS\tAC=115;AN=158418;AF=7.25928e-04;rf_tp_probability=7.95269e-02;FS=0.00000e+00;InbreedingCoeff=-2.25000e-02;MQ=3.73300e+01;MQRankSum=1.50000e-01;QD=2.04000e+00;ReadPosRankSum=1.17000e+00;SOR=7.28000e-01;BaseQRankSum=1.13000e+00;ClippingRankSum=-5.00000e-02;DP=15204365;VQSLOD=7.77000e-01;VQSR_culprit=QD;segdup;variant_type=snv;allele_type=snv;n_alt_alleles=1;pab_max=1.00000e+00;gq_hist_alt_bin_freq=1|2|6|1|8|3|7|10|7|9|7|17|7|8|3|9|10|8|7|438;gq_hist_all_bin_freq=7609|15800|6167|7789|3870|1025|1258|757|315|541|455|262|836|123|640|265|975|119|1076|71788;dp_hist_alt_bin_freq=12|22|21|7|3|6|17|12|16|15|15|16|10|11|7|12|10|5|11|6;dp_hist_alt_n_larger=334;dp_hist_all_bin_freq=32846|13179|2452|1189|1471|1375|15217|12503|6056|2548|1435|1313|1094|1049|958|967|931|807|799|863;dp_hist_all_n_larger=26696;ab_hist_alt_bin_freq=0|30|237|152|68|33|20|2|7|4|8|0|3|2|0|1|0|0|0|0;AC_nfe_seu=0;AN_nfe_seu=2184;AF_nfe_seu=0.00000e+00;nhomalt_nfe_seu=0;controls_AC_afr_male=1;controls_AN_afr_male=1328;controls_AF_afr_male=7.53012e-04;controls_nhomalt_afr_male=0;non_neuro_AC_eas_kor=0;non_neuro_AN_eas_kor=1888;non_neuro_AF_eas_kor=0.00000e+00;non_neuro_nhomalt_eas_kor=0;non_topmed_AC_amr=5;non_topmed_AN_amr=24704;non_topmed_AF_amr=2.02396e-04;non_topmed_nhomalt_amr=0;non_cancer_AC_asj_female=0;non_cancer_AN_asj_female=3900;non_cancer_AF_asj_female=0.00000e+00;non_cancer_nhomalt_asj_female=0;AC_raw=569;AN_raw=243340;AF_raw=2.33829e-03;nhomalt_raw=1;AC_fin_female=24;AN_fin_female=8714;AF_fin_female=2.75419e-03;nhomalt_fin_female=0;non_cancer_AC_oth_female=0;non_cancer_AN_oth_female=2112;non_cancer_AF_oth_female=0.00000e+00;non_cancer_nhomalt_oth_female=0;AC_nfe_bgr=3;AN_nfe_bgr=1566;AF_nfe_bgr=1.91571e-03;nhomalt_nfe_bgr=0;non_neuro_AC_asj_female=0;non_neuro_AN_asj_female=2264;non_neuro_AF_asj_female=0.00000e+00;non_neuro_nhomalt_asj_female=0;AC_sas_male=5;AN_sas_male=17392;AF_sas_male=2.87489e-04;nhomalt_sas_male=0;non_neuro_AC_afr_male=6;non_neuro_AN_afr_male=3138;non_neuro_AF_afr_male=1.91205e-03;non_neuro_nhomalt_afr_male=0;AC_afr_male=6;AN_afr_male=3160;AF_afr_male=1.89873e-03;nhomalt_afr_male=0;AC_afr=13;AN_afr=7836;AF_afr=1.65901e-03;nhomalt_afr=0;controls_AC_nfe_swe=1;controls_AN_nfe_swe=1052;controls_AF_nfe_swe=9.50570e-04;controls_nhomalt_nfe_swe=0;non_neuro_AC_afr_female=7;non_neuro_AN_afr_female=4660;non_neuro_AF_afr_female=1.50215e-03;non_neuro_nhomalt_afr_female=0;non_topmed_AC_amr_female=4;non_topmed_AN_amr_female=14238;non_topmed_AF_amr_female=2.80938e-04;non_topmed_nhomalt_amr_female=0;non_cancer_AC_female=53;non_cancer_AN_female=70682;non_cancer_AF_female=7.49837e-04;non_cancer_nhomalt_female=0;non_cancer_AC_nfe_onf=7;non_cancer_AN_nfe_onf=16978;non_cancer_AF_nfe_onf=4.12298e-04;non_cancer_nhomalt_nfe_onf=0;non_cancer_AC_male=58;non_cancer_AN_male=82754;non_cancer_AF_male=7.00872e-04;non_cancer_nhomalt_male=0;non_topmed_AC_oth_female=0;non_topmed_AN_oth_female=2186;non_topmed_AF_oth_female=0.00000e+00;non_topmed_nhomalt_oth_female=0;AC_eas_female=1;AN_eas_female=5472;AF_eas_female=1.82749e-04;nhomalt_eas_female=0;non_cancer_AC_sas_female=1;non_cancer_AN_sas_female=5728;non_cancer_AF_sas_female=1.74581e-04;non_cancer_nhomalt_sas_female=0;AC_afr_female=7;AN_afr_female=4676;AF_afr_female=1.49701e-03;nhomalt_afr_female=0;AC_sas=6;AN_sas=23136;AF_sas=2.59336e-04;nhomalt_sas=0;non_neuro_AC_female=42;non_neuro_AN_female=62376;non_neuro_AF_female=6.73336e-04;non_neuro_nhomalt_female=0;controls_AC_afr=4;controls_AN_afr=3130;controls_AF_afr=1.27796e-03;controls_nhomalt_afr=0;non_neuro_AC_eas_jpn=0;non_neuro_AN_eas_jpn=100;non_neuro_AF_eas_jpn=0.00000e+00;non_neuro_nhomalt_eas_jpn=0;AC_nfe_onf=7;AN_nfe_onf=18732;AF_nfe_onf=3.73692e-04;nhomalt_nfe_onf=0;non_cancer_AC_amr_male=1;non_cancer_AN_amr_male=10464;non_cancer_AF_amr_male=9.55657e-05;non_cancer_nhomalt_amr_male=0;controls_AC_fin_male=17;controls_AN_fin_male=5446;controls_AF_fin_male=3.12156e-03;controls_nhomalt_fin_male=0;non_neuro_AC_nfe_nwe=19;non_neuro_AN_nfe_nwe=29736;non_neuro_AF_nfe_nwe=6.38956e-04;non_neuro_nhomalt_nfe_nwe=0;AC_fin_male=22;AN_fin_male=7998;AF_fin_male=2.75069e-03;nhomalt_fin_male=0;AC_nfe_female=18;AN_nfe_female=29168;AF_nfe_female=6.17115e-04;nhomalt_nfe_female=0;AC_amr=5;AN_amr=24760;AF_amr=2.01939e-04;nhomalt_amr=0;non_topmed_AC_nfe_male=26;non_topmed_AN_nfe_male=32272;non_topmed_AF_nfe_male=8.05652e-04;non_topmed_nhomalt_nfe_male=0;non_neuro_AC_sas=6;non_neuro_AN_sas=23130;non_neuro_AF_sas=2.59403e-04;non_neuro_nhomalt_sas=0;non_cancer_AC_fin_male=22;non_cancer_AN_fin_male=7996;non_cancer_AF_fin_male=2.75138e-03;non_cancer_nhomalt_fin_male=0;non_cancer_AC_nfe_seu=0;non_cancer_AN_nfe_seu=1954;non_cancer_AF_nfe_seu=0.00000e+00;non_cancer_nhomalt_nfe_seu=0;AC_eas=1;AN_eas=11008;AF_eas=9.08430e-05;nhomalt_eas=0;nhomalt=0;non_neuro_AC_nfe_female=14;non_neuro_AN_nfe_female=24634;non_neuro_AF_nfe_female=5.68320e-04;non_neuro_nhomalt_nfe_female=0;non_neuro_AC_afr=13;non_neuro_AN_afr=7798;non_neuro_AF_afr=1.66709e-03;non_neuro_nhomalt_afr=0;controls_AC_raw=284;controls_AN_raw=105840;controls_AF_raw=2.68330e-03;controls_nhomalt_raw=1;non_cancer_AC_eas=1;non_cancer_AN_eas=10736;non_cancer_AF_eas=9.31446e-05;non_cancer_nhomalt_eas=0;non_cancer_AC_amr_female=4;non_cancer_AN_amr_female=14204;non_cancer_AF_amr_female=2.81611e-04;non_cancer_nhomalt_amr_female=0;non_neuro_AC_nfe_swe=3;non_neuro_AN_nfe_swe=2476;non_neuro_AF_nfe_swe=1.21163e-03;non_neuro_nhomalt_nfe_swe=0;controls_AC_male=26;controls_AN_male=34942;controls_AF_male=7.44090e-04;controls_nhomalt_male=0;non_topmed_AC_male=57;non_topmed_AN_male=83350;non_topmed_AF_male=6.83863e-04;non_topmed_nhomalt_male=0;controls_AC_eas_jpn=0;controls_AN_eas_jpn=74;controls_AF_eas_jpn=0.00000e+00;controls_nhomalt_eas_jpn=0;controls_AC_nfe_female=8;controls_AN_nfe_female=9550;controls_AF_nfe_female=8.37696e-04;controls_nhomalt_nfe_female=0;non_neuro_AC_amr=3;non_neuro_AN_amr=20718;non_neuro_AF_amr=1.44802e-04;non_neuro_nhomalt_amr=0;non_neuro_AC_eas_female=0;non_neuro_AN_eas_female=4200;non_neuro_AF_eas_female=0.00000e+00;non_neuro_nhomalt_eas_female=0;AC_asj_male=0;AN_asj_male=4482;AF_asj_male=0.00000e+00;nhomalt_asj_male=0;controls_AC_nfe_male=6;controls_AN_nfe_male=11058;controls_AF_nfe_male=5.42594e-04;controls_nhomalt_nfe_male=0;non_neuro_AC_fin=36;non_neuro_AN_fin=13318;non_neuro_AF_fin=2.70311e-03;non_neuro_nhomalt_fin=0;non_topmed_AC_sas=6;non_topmed_AN_sas=23136;non_topmed_AF_sas=2.59336e-04;non_topmed_nhomalt_sas=0;non_cancer_AC_nfe_female=17;non_cancer_AN_nfe_female=26546;non_cancer_AF_nfe_female=6.40398e-04;non_cancer_nhomalt_nfe_female=0;AC_oth_female=0;AN_oth_female=2216;AF_oth_female=0.00000e+00;nhomalt_oth_female=0;non_cancer_AC_asj=0;non_cancer_AN_asj=8290;non_cancer_AF_asj=0.00000e+00;non_cancer_nhomalt_asj=0;AC_nfe_swe=3;AN_nfe_swe=3014;AF_nfe_swe=9.95355e-04;nhomalt_nfe_swe=0;controls_AC_nfe=14;controls_AN_nfe=20608;controls_AF_nfe=6.79348e-04;controls_nhomalt_nfe=0;controls_AC_oth_female=0;controls_AN_oth_female=712;controls_AF_oth_female=0.00000e+00;controls_nhomalt_oth_female=0;controls_AC_asj=0;controls_AN_asj=1502;controls_AF_asj=0.00000e+00;controls_nhomalt_asj=0;non_neuro_AC_amr_male=0;non_neuro_AN_amr_male=8440;non_neuro_AF_amr_male=0.00000e+00;non_neuro_nhomalt_amr_male=0;controls_AC_nfe_nwe=11;controls_AN_nfe_nwe=12378;controls_AF_nfe_nwe=8.88673e-04;controls_nhomalt_nfe_nwe=0;AC_nfe_nwe=30;AN_nfe_nwe=36248;AF_nfe_nwe=8.27632e-04;nhomalt_nfe_nwe=0;controls_AC_nfe_seu=0;controls_AN_nfe_seu=540;controls_AF_nfe_seu=0.00000e+00;controls_nhomalt_nfe_seu=0;controls_AC_sas_female=1;controls_AN_sas_female=3178;controls_AF_sas_female=3.14663e-04;controls_nhomalt_sas_female=0;non_neuro_AC_amr_female=3;non_neuro_AN_amr_female=12278;non_neuro_AF_amr_female=2.44339e-04;non_neuro_nhomalt_amr_female=0;non_cancer_AC_eas_jpn=0;non_cancer_AN_eas_jpn=84;non_cancer_AF_eas_jpn=0.00000e+00;non_cancer_nhomalt_eas_jpn=0;non_neuro_AC_nfe_onf=6;non_neuro_AN_nfe_onf=16176;non_neuro_AF_nfe_onf=3.70920e-04;non_neuro_nhomalt_nfe_onf=0;non_topmed_AC_eas_male=0;non_topmed_AN_eas_male=5532;non_topmed_AF_eas_male=0.00000e+00;non_topmed_nhomalt_eas_male=0;AC_eas_jpn=0;AN_eas_jpn=102;AF_eas_jpn=0.00000e+00;nhomalt_eas_jpn=0;non_cancer_AC_afr_male=5;non_cancer_AN_afr_male=3040;non_cancer_AF_afr_male=1.64474e-03;non_cancer_nhomalt_afr_male=0;non_cancer_AC_afr=11;non_cancer_AN_afr=7232;non_cancer_AF_afr=1.52102e-03;non_cancer_nhomalt_afr=0;controls_AC_amr_female=2;controls_AN_amr_female=7270;controls_AF_amr_female=2.75103e-04;controls_nhomalt_amr_female=0;non_neuro_AC_fin_male=19;non_neuro_AN_fin_male=6558;non_neuro_AF_fin_male=2.89722e-03;non_neuro_nhomalt_fin_male=0;AC_female=55;AN_female=74284;AF_female=7.40402e-04;nhomalt_female=0;non_neuro_AC_nfe_bgr=0;non_neuro_AN_nfe_bgr=274;non_neuro_AF_nfe_bgr=0.00000e+00;non_neuro_nhomalt_nfe_bgr=0;non_neuro_AC_oth_male=0;non_neuro_AN_oth_male=1782;non_neuro_AF_oth_male=0.00000e+00;non_neuro_nhomalt_oth_male=0;non_topmed_AC_nfe_est=1;non_topmed_AN_nfe_est=212;non_topmed_AF_nfe_est=4.71698e-03;non_topmed_nhomalt_nfe_est=0;non_topmed_AC_nfe_nwe=30;non_topmed_AN_nfe_nwe=35430;non_topmed_AF_nfe_nwe=8.46740e-04;non_topmed_nhomalt_nfe_nwe=0;non_topmed_AC_amr_male=1;non_topmed_AN_amr_male=10466;non_topmed_AF_amr_male=9.55475e-05;non_topmed_nhomalt_amr_male=0;non_cancer_AC_amr=5;non_cancer_AN_amr=24668;non_cancer_AF_amr=2.02692e-04;non_cancer_nhomalt_amr=0;non_topmed_AC_nfe_swe=3;non_topmed_AN_nfe_swe=2998;non_topmed_AF_nfe_swe=1.00067e-03;non_topmed_nhomalt_nfe_swe=0;non_topmed_AC_nfe_onf=7;non_topmed_AN_nfe_onf=18358;non_topmed_AF_nfe_onf=3.81305e-04;non_topmed_nhomalt_nfe_onf=0;controls_AC_eas_kor=0;controls_AN_eas_kor=936;controls_AF_eas_kor=0.00000e+00;controls_nhomalt_eas_kor=0;non_topmed_AC_eas_oea=1;non_topmed_AN_eas_oea=9012;non_topmed_AF_eas_oea=1.10963e-04;non_topmed_nhomalt_eas_oea=0;controls_AC_eas_male=0;controls_AN_eas_male=2078;controls_AF_eas_male=0.00000e+00;controls_nhomalt_eas_male=0;controls_AC_oth_male=0;controls_AN_oth_male=682;controls_AF_oth_male=0.00000e+00;controls_nhomalt_oth_male=0;non_topmed_AC=112;non_topmed_AN=156502;non_topmed_AF=7.15646e-04;non_topmed_nhomalt=0;controls_AC_fin=32;controls_AN_fin=11214;controls_AF_fin=2.85358e-03;controls_nhomalt_fin=0;AC_eas_kor=0;AN_eas_kor=1890;AF_eas_kor=0.00000e+00;nhomalt_eas_kor=0;non_neuro_AC_nfe=28;non_neuro_AN_nfe=50558;non_neuro_AF_nfe=5.53819e-04;non_neuro_nhomalt_nfe=0;non_neuro_AC_fin_female=17;non_neuro_AN_fin_female=6760;non_neuro_AF_fin_female=2.51479e-03;non_neuro_nhomalt_fin_female=0;non_cancer_AC_nfe_male=25;non_cancer_AN_nfe_male=31792;non_cancer_AF_nfe_male=7.86361e-04;non_cancer_nhomalt_nfe_male=0;controls_AC_eas_oea=0;controls_AN_eas_oea=3270;controls_AF_eas_oea=0.00000e+00;controls_nhomalt_eas_oea=0;non_topmed_AC_nfe_seu=0;non_topmed_AN_nfe_seu=2170;non_topmed_AF_nfe_seu=0.00000e+00;non_topmed_nhomalt_nfe_seu=0;controls_AC_eas_female=0;controls_AN_eas_female=2202;controls_AF_eas_female=0.00000e+00;controls_nhomalt_eas_female=0;non_topmed_AC_asj=0;non_topmed_AN_asj=8452;non_topmed_AF_asj=0.00000e+00;non_topmed_nhomalt_asj=0;controls_AC_nfe_onf=2;controls_AN_nfe_onf=6490;controls_AF_nfe_onf=3.08166e-04;controls_nhomalt_nfe_onf=0;non_neuro_AC=86;non_neuro_AN=132372;non_neuro_AF=6.49684e-04;non_neuro_nhomalt=0;AC_eas_oea=1;AN_eas_oea=9016;AF_eas_oea=1.10914e-04;nhomalt_eas_oea=0;non_topmed_AC_nfe=44;non_topmed_AN_nfe=60734;non_topmed_AF_nfe=7.24471e-04;non_topmed_nhomalt_nfe=0;non_cancer_AC_oth=0;non_cancer_AN_oth=4354;non_cancer_AF_oth=0.00000e+00;non_cancer_nhomalt_oth=0;non_topmed_AC_raw=558;non_topmed_AN_raw=237280;non_topmed_AF_raw=2.35165e-03;non_topmed_nhomalt_raw=1;non_neuro_AC_nfe_est=0;non_neuro_AN_nfe_est=190;non_neuro_AF_nfe_est=0.00000e+00;non_neuro_nhomalt_nfe_est=0;non_topmed_AC_oth_male=0;non_topmed_AN_oth_male=2260;non_topmed_AF_oth_male=0.00000e+00;non_topmed_nhomalt_oth_male=0;non_cancer_AC_oth_male=0;non_cancer_AN_oth_male=2242;non_cancer_AF_oth_male=0.00000e+00;non_cancer_nhomalt_oth_male=0;AC_nfe_est=1;AN_nfe_est=216;AF_nfe_est=4.62963e-03;nhomalt_nfe_est=0;non_cancer_AC_afr_female=6;non_cancer_AN_afr_female=4192;non_cancer_AF_afr_female=1.43130e-03;non_cancer_nhomalt_afr_female=0;non_topmed_AC_afr_male=3;non_topmed_AN_afr_male=2976;non_topmed_AF_afr_male=1.00806e-03;non_topmed_nhomalt_afr_male=0;AC_eas_male=0;AN_eas_male=5536;AF_eas_male=0.00000e+00;nhomalt_eas_male=0;controls_AC_eas=0;controls_AN_eas=4280;controls_AF_eas=0.00000e+00;controls_nhomalt_eas=0;non_neuro_AC_eas_male=0;non_neuro_AN_eas_male=4280;non_neuro_AF_eas_male=0.00000e+00;non_neuro_nhomalt_eas_male=0;non_cancer_AC_nfe_nwe=28;non_cancer_AN_nfe_nwe=34842;non_cancer_AF_nfe_nwe=8.03628e-04;non_cancer_nhomalt_nfe_nwe=0;controls_AC_sas=3;controls_AN_sas=11616;controls_AF_sas=2.58264e-04;controls_nhomalt_sas=0;non_neuro_AC_sas_male=5;non_neuro_AN_sas_male=17386;non_neuro_AF_sas_male=2.87588e-04;non_neuro_nhomalt_sas_male=0;non_neuro_AC_asj_male=0;non_neuro_AN_asj_male=2488;non_neuro_AF_asj_male=0.00000e+00;non_neuro_nhomalt_asj_male=0;non_cancer_AC_nfe_bgr=3;non_cancer_AN_nfe_bgr=1524;non_cancer_AF_nfe_bgr=1.96850e-03;non_cancer_nhomalt_nfe_bgr=0;controls_AC_oth=0;controls_AN_oth=1394;controls_AF_oth=0.00000e+00;controls_nhomalt_oth=0;non_cancer_AC_eas_female=1;non_cancer_AN_eas_female=5294;non_cancer_AF_eas_female=1.88893e-04;non_cancer_nhomalt_eas_female=0;AC_nfe=44;AN_nfe=61960;AF_nfe=7.10136e-04;nhomalt_nfe=0;non_topmed_AC_female=55;non_topmed_AN_female=73152;non_topmed_AF_female=7.51859e-04;non_topmed_nhomalt_female=0;non_neuro_AC_asj=0;non_neuro_AN_asj=4752;non_neuro_AF_asj=0.00000e+00;non_neuro_nhomalt_asj=0;non_topmed_AC_eas_female=1;non_topmed_AN_eas_female=5472;non_topmed_AF_eas_female=1.82749e-04;non_topmed_nhomalt_eas_female=0;non_neuro_AC_raw=467;non_neuro_AN_raw=201738;non_neuro_AF_raw=2.31488e-03;non_neuro_nhomalt_raw=1;non_topmed_AC_eas=1;non_topmed_AN_eas=11004;non_topmed_AF_eas=9.08760e-05;non_topmed_nhomalt_eas=0;non_topmed_AC_fin_male=22;non_topmed_AN_fin_male=7998;non_topmed_AF_fin_male=2.75069e-03;non_topmed_nhomalt_fin_male=0;non_cancer_AC_asj_male=0;non_cancer_AN_asj_male=4390;non_cancer_AF_asj_male=0.00000e+00;non_cancer_nhomalt_asj_male=0;AC_fin=46;AN_fin=16712;AF_fin=2.75251e-03;nhomalt_fin=0;AC_nfe_male=26;AN_nfe_male=32792;AF_nfe_male=7.92876e-04;nhomalt_nfe_male=0;non_topmed_AC_eas_kor=0;non_topmed_AN_eas_kor=1890;non_topmed_AF_eas_kor=0.00000e+00;non_topmed_nhomalt_eas_kor=0;controls_AC_amr_male=0;controls_AN_amr_male=5156;controls_AF_amr_male=0.00000e+00;controls_nhomalt_amr_male=0;non_neuro_AC_eas_oea=0;non_neuro_AN_eas_oea=6492;non_neuro_AF_eas_oea=0.00000e+00;non_neuro_nhomalt_eas_oea=0;AC_sas_female=1;AN_sas_female=5744;AF_sas_female=1.74095e-04;nhomalt_sas_female=0;controls_AC_afr_female=3;controls_AN_afr_female=1802;controls_AF_afr_female=1.66482e-03;controls_nhomalt_afr_female=0;controls_AC_amr=2;controls_AN_amr=12426;controls_AF_amr=1.60953e-04;controls_nhomalt_amr=0;non_topmed_AC_eas_jpn=0;non_topmed_AN_eas_jpn=102;non_topmed_AF_eas_jpn=0.00000e+00;non_topmed_nhomalt_eas_jpn=0;AC_asj_female=0;AN_asj_female=4024;AF_asj_female=0.00000e+00;nhomalt_asj_female=0;non_topmed_AC_nfe_bgr=3;non_topmed_AN_nfe_bgr=1566;non_topmed_AF_nfe_bgr=1.91571e-03;non_topmed_nhomalt_nfe_bgr=0;non_cancer_AC_nfe_est=1;non_cancer_AN_nfe_est=150;non_cancer_AF_nfe_est=6.66667e-03;non_cancer_nhomalt_nfe_est=0;non_neuro_AC_eas=0;non_neuro_AN_eas=8480;non_neuro_AF_eas=0.00000e+00;non_neuro_nhomalt_eas=0;non_cancer_AC_nfe=42;non_cancer_AN_nfe=58338;non_cancer_AF_nfe=7.19942e-04;non_cancer_nhomalt_nfe=0;non_neuro_AC_male=44;non_neuro_AN_male=69996;non_neuro_AF_male=6.28607e-04;non_neuro_nhomalt_male=0;non_neuro_AC_sas_female=1;non_neuro_AN_sas_female=5744;non_neuro_AF_sas_female=1.74095e-04;non_neuro_nhomalt_sas_female=0;AC_asj=0;AN_asj=8506;AF_asj=0.00000e+00;nhomalt_asj=0;controls_AC_nfe_est=0;controls_AN_nfe_est=64;controls_AF_nfe_est=0.00000e+00;controls_nhomalt_nfe_est=0;non_topmed_AC_asj_female=0;non_topmed_AN_asj_female=3998;non_topmed_AF_asj_female=0.00000e+00;non_topmed_nhomalt_asj_female=0;non_cancer_AC_nfe_swe=3;non_cancer_AN_nfe_swe=2890;non_cancer_AF_nfe_swe=1.03806e-03;non_cancer_nhomalt_nfe_swe=0;non_cancer_AC=111;non_cancer_AN=153436;non_cancer_AF=7.23429e-04;non_cancer_nhomalt=0;non_topmed_AC_oth=0;non_topmed_AN_oth=4446;non_topmed_AF_oth=0.00000e+00;non_topmed_nhomalt_oth=0;non_topmed_AC_fin_female=24;non_topmed_AN_fin_female=8712;non_topmed_AF_fin_female=2.75482e-03;non_topmed_nhomalt_fin_female=0;non_cancer_AC_fin_female=24;non_cancer_AN_fin_female=8706;non_cancer_AF_fin_female=2.75672e-03;non_cancer_nhomalt_fin_female=0;AC_oth=0;AN_oth=4500;AF_oth=0.00000e+00;nhomalt_oth=0;non_neuro_AC_nfe_male=14;non_neuro_AN_nfe_male=25924;non_neuro_AF_nfe_male=5.40040e-04;non_neuro_nhomalt_nfe_male=0;controls_AC_female=29;controls_AN_female=31228;controls_AF_female=9.28654e-04;controls_nhomalt_female=0;non_cancer_AC_fin=46;non_cancer_AN_fin=16702;non_cancer_AF_fin=2.75416e-03;non_cancer_nhomalt_fin=0;non_topmed_AC_fin=46;non_topmed_AN_fin=16710;non_topmed_AF_fin=2.75284e-03;non_topmed_nhomalt_fin=0;non_cancer_AC_eas_oea=1;non_cancer_AN_eas_oea=8768;non_cancer_AF_eas_oea=1.14051e-04;non_cancer_nhomalt_eas_oea=0;non_topmed_AC_nfe_female=18;non_topmed_AN_nfe_female=28462;non_topmed_AF_nfe_female=6.32422e-04;non_topmed_nhomalt_nfe_female=0;non_cancer_AC_sas_male=5;non_cancer_AN_sas_male=17388;non_cancer_AF_sas_male=2.87555e-04;non_cancer_nhomalt_sas_male=0;controls_AC_asj_male=0;controls_AN_asj_male=756;controls_AF_asj_male=0.00000e+00;controls_nhomalt_asj_male=0;non_cancer_AC_raw=554;non_cancer_AN_raw=229614;non_cancer_AF_raw=2.41274e-03;non_cancer_nhomalt_raw=1;non_cancer_AC_eas_male=0;non_cancer_AN_eas_male=5442;non_cancer_AF_eas_male=0.00000e+00;non_cancer_nhomalt_eas_male=0;non_topmed_AC_asj_male=0;non_topmed_AN_asj_male=4454;non_topmed_AF_asj_male=0.00000e+00;non_topmed_nhomalt_asj_male=0;non_neuro_AC_oth=0;non_neuro_AN_oth=3618;non_neuro_AF_oth=0.00000e+00;non_neuro_nhomalt_oth=0;AC_male=60;AN_male=84134;AF_male=7.13148e-04;nhomalt_male=0;controls_AC_fin_female=15;controls_AN_fin_female=5768;controls_AF_fin_female=2.60055e-03;controls_nhomalt_fin_female=0;controls_AC_nfe_bgr=0;controls_AN_nfe_bgr=84;controls_AF_nfe_bgr=0.00000e+00;controls_nhomalt_nfe_bgr=0;controls_AC_asj_female=0;controls_AN_asj_female=746;controls_AF_asj_female=0.00000e+00;controls_nhomalt_asj_female=0;AC_amr_male=1;AN_amr_male=10490;AF_amr_male=9.53289e-05;nhomalt_amr_male=0;AC_amr_female=4;AN_amr_female=14270;AF_amr_female=2.80308e-04;nhomalt_amr_female=0;non_topmed_AC_sas_male=5;non_topmed_AN_sas_male=17392;non_topmed_AF_sas_male=2.87489e-04;non_topmed_nhomalt_sas_male=0;AC_oth_male=0;AN_oth_male=2284;AF_oth_male=0.00000e+00;nhomalt_oth_male=0;non_cancer_AC_sas=6;non_cancer_AN_sas=23116;non_cancer_AF_sas=2.59560e-04;non_cancer_nhomalt_sas=0;non_neuro_AC_nfe_seu=0;non_neuro_AN_nfe_seu=1706;non_neuro_AF_nfe_seu=0.00000e+00;non_neuro_nhomalt_nfe_seu=0;non_cancer_AC_eas_kor=0;non_cancer_AN_eas_kor=1884;non_cancer_AF_eas_kor=0.00000e+00;non_cancer_nhomalt_eas_kor=0;non_topmed_AC_afr_female=7;non_topmed_AN_afr_female=4340;non_topmed_AF_afr_female=1.61290e-03;non_topmed_nhomalt_afr_female=0;controls_AC_sas_male=2;controls_AN_sas_male=8438;controls_AF_sas_male=2.37023e-04;controls_nhomalt_sas_male=0;non_topmed_AC_sas_female=1;non_topmed_AN_sas_female=5744;non_topmed_AF_sas_female=1.74095e-04;non_topmed_nhomalt_sas_female=0;non_topmed_AC_afr=10;non_topmed_AN_afr=7316;non_topmed_AF_afr=1.36687e-03;non_topmed_nhomalt_afr=0;controls_AC=55;controls_AN=66170;controls_AF=8.31192e-04;controls_nhomalt=0;non_neuro_AC_oth_female=0;non_neuro_AN_oth_female=1836;non_neuro_AF_oth_female=0.00000e+00;non_neuro_nhomalt_oth_female=0;non_topmed_faf95_amr=7.92900e-05;non_topmed_faf99_amr=7.97300e-05;faf95_afr=9.80670e-04;faf99_afr=9.81210e-04;faf95_sas=1.12670e-04;faf99_sas=1.12740e-04;controls_faf95_afr=4.36430e-04;controls_faf99_afr=4.35830e-04;faf95_amr=7.91500e-05;faf99_amr=7.86300e-05;non_neuro_faf95_sas=1.12700e-04;non_neuro_faf99_sas=1.12750e-04;faf95_eas=0.00000e+00;faf99_eas=0.00000e+00;faf95=6.18270e-04;faf99=6.17740e-04;non_neuro_faf95_afr=9.86070e-04;non_neuro_faf99_afr=9.85750e-04;non_cancer_faf95_eas=0.00000e+00;non_cancer_faf99_eas=0.00000e+00;non_neuro_faf95_amr=3.93000e-05;non_neuro_faf99_amr=3.86000e-05;non_topmed_faf95_sas=1.12670e-04;non_topmed_faf99_sas=1.12740e-04;controls_faf95_nfe=4.10450e-04;controls_faf99_nfe=4.10350e-04;non_cancer_faf95_afr=8.52040e-04;non_cancer_faf99_afr=8.52100e-04;non_cancer_faf95_amr=7.93800e-05;non_cancer_faf99_amr=7.97900e-05;non_topmed_faf95=6.07440e-04;non_topmed_faf99=6.07390e-04;non_neuro_faf95_nfe=3.93460e-04;non_neuro_faf99_nfe=3.92690e-04;non_neuro_faf95=5.38290e-04;non_neuro_faf99=5.37960e-04;non_topmed_faf95_nfe=5.54100e-04;non_topmed_faf99_nfe=5.54540e-04;controls_faf95_eas=0.00000e+00;controls_faf99_eas=0.00000e+00;controls_faf95_sas=7.01300e-05;controls_faf99_sas=6.98400e-05;faf95_nfe=5.43300e-04;faf99_nfe=5.42940e-04;non_topmed_faf95_eas=0.00000e+00;non_topmed_faf99_eas=0.00000e+00;controls_faf95_amr=2.85500e-05;controls_faf99_amr=2.79100e-05;non_neuro_faf95_eas=0.00000e+00;non_neuro_faf99_eas=0.00000e+00;non_cancer_faf95_nfe=5.47030e-04;non_cancer_faf99_nfe=5.46640e-04;non_cancer_faf95=6.14180e-04;non_cancer_faf99=6.13420e-04;non_cancer_faf95_sas=1.12750e-04;non_cancer_faf99_sas=1.12790e-04;non_topmed_faf95_afr=7.40690e-04;non_topmed_faf99_afr=7.41080e-04;controls_faf95=6.55500e-04;controls_faf99=6.55770e-04;popmax=afr;AC_popmax=13;AN_popmax=7836;AF_popmax=1.65901e-03;nhomalt_popmax=0;age_hist_het_bin_freq=2|4|11|11|3|11|7|4|2|3;age_hist_het_n_smaller=4;age_hist_het_n_larger=1;age_hist_hom_bin_freq=0|0|0|0|0|0|0|0|0|0;age_hist_hom_n_smaller=0;age_hist_hom_n_larger=0;non_topmed_popmax=afr;non_topmed_AC_popmax=10;non_topmed_AN_popmax=7316;non_topmed_AF_popmax=1.36687e-03;non_topmed_nhomalt_popmax=0;non_neuro_popmax=afr;non_neuro_AC_popmax=13;non_neuro_AN_popmax=7798;non_neuro_AF_popmax=1.66709e-03;non_neuro_nhomalt_popmax=0;non_cancer_popmax=afr;non_cancer_AC_popmax=11;non_cancer_AN_popmax=7232;non_cancer_AF_popmax=1.52102e-03;non_cancer_nhomalt_popmax=0;controls_popmax=afr;controls_AC_popmax=4;controls_AN_popmax=3130;controls_AF_popmax=1.27796e-03;controls_nhomalt_popmax=0;vep=A|intron_variant&non_coding_transcript_variant|MODIFIER|WASH7P|ENSG00000227232|Transcript|ENST00000423562|unprocessed_pseudogene||4/9|ENST00000423562.1:n.489-116C>T|||||||rs753281850|1||-1||SNV|1|HGNC|38034|||||||||||||||A:0.001791||||||||A:0.002174|A:6.762e-04|A:0.009665|A:0.002926|A:0|A:0.008855|A:0.001799|A:0||||||||||||,A|intron_variant&non_coding_transcript_variant|MODIFIER|WASH7P|ENSG00000227232|Transcript|ENST00000438504|unprocessed_pseudogene||5/11|ENST00000438504.2:n.604+118C>T|||||||rs753281850|1||-1||SNV|1|HGNC|38034|YES||||||||||||||A:0.001791||||||||A:0.002174|A:6.762e-04|A:0.009665|A:0.002926|A:0|A:0.008855|A:0.001799|A:0||||||||||||,A|downstream_gene_variant|MODIFIER|DDX11L1|ENSG00000223972|Transcript|ENST00000450305|transcribed_unprocessed_pseudogene||||||||||rs753281850|1|3814|1||SNV|1|HGNC|37102|||||||||||||||A:0.001791||||||||A:0.002174|A:6.762e-04|A:0.009665|A:0.002926|A:0|A:0.008855|A:0.001799|A:0||||||||||||,A|downstream_gene_variant|MODIFIER|DDX11L1|ENSG00000223972|Transcript|ENST00000456328|processed_transcript||||||||||rs753281850|1|3075|1||SNV|1|HGNC|37102|YES||||||||||||||A:0.001791||||||||A:0.002174|A:6.762e-04|A:0.009665|A:0.002926|A:0|A:0.008855|A:0.001799|A:0||||||||||||,A|intron_variant&non_coding_transcript_variant|MODIFIER|WASH7P|ENSG00000227232|Transcript|ENST00000488147|unprocessed_pseudogene||5/10|ENST00000488147.1:n.575-116C>T|||||||rs753281850|1||-1||SNV|1|HGNC|38034|||||||||||||||A:0.001791||||||||A:0.002174|A:6.762e-04|A:0.009665|A:0.002926|A:0|A:0.008855|A:0.001799|A:0||||||||||||,A|downstream_gene_variant|MODIFIER|DDX11L1|ENSG00000223972|Transcript|ENST00000515242|transcribed_unprocessed_pseudogene||||||||||rs753281850|1|3072|1||SNV|1|HGNC|37102|||||||||||||||A:0.001791||||||||A:0.002174|A:6.762e-04|A:0.009665|A:0.002926|A:0|A:0.008855|A:0.001799|A:0||||||||||||,A|downstream_gene_variant|MODIFIER|DDX11L1|ENSG00000223972|Transcript|ENST00000518655|transcribed_unprocessed_pseudogene||||||||||rs753281850|1|3075|1||SNV|1|HGNC|37102|||||||||||||||A:0.001791||||||||A:0.002174|A:6.762e-04|A:0.009665|A:0.002926|A:0|A:0.008855|A:0.001799|A:0||||||||||||,A|intron_variant&non_coding_transcript_variant|MODIFIER|WASH7P|ENSG00000227232|Transcript|ENST00000538476|unprocessed_pseudogene||5/12|ENST00000538476.1:n.815+118C>T|||||||rs753281850|1||-1||SNV|1|HGNC|38034|||||||||||||||A:0.001791||||||||A:0.002174|A:6.762e-04|A:0.009665|A:0.002926|A:0|A:0.008855|A:0.001799|A:0||||||||||||,A|intron_variant&non_coding_transcript_variant|MODIFIER|WASH7P|ENSG00000227232|Transcript|ENST00000541675|unprocessed_pseudogene||5/8|ENST00000541675.1:n.546+14C>T|||||||rs753281850|1||-1||SNV|1|HGNC|38034|||||||||||||||A:0.001791||||||||A:0.002174|A:6.762e-04|A:0.009665|A:0.002926|A:0|A:0.008855|A:0.001799|A:0||||||||||||";
            Allele expected = new Allele(1, 17484, "G", "A");
            expected.setRsId("rs753281850");
            // AC_afr=13;AN_afr=7836;AF_afr=1.65901e-03;nhomalt_afr=0
            expected.addFrequency(AlleleData.frequencyOf(GNOMAD_E_AFR, 13, 7836));
            expected.addFrequency(AlleleData.frequencyOf(GNOMAD_E_AMR, 5, 24760));
            expected.addFrequency(AlleleData.frequencyOf(GNOMAD_E_EAS, 1, 11008));
            expected.addFrequency(AlleleData.frequencyOf(GNOMAD_E_FIN, 46, 16712));
            expected.addFrequency(AlleleData.frequencyOf(GNOMAD_E_NFE, 44, 61960));
            expected.addFrequency(AlleleData.frequencyOf(GNOMAD_E_SAS, 6, 23136));

            assertParseResultsEquals(parseLine(line), List.of(expected));
        }

        @Test
        void name() {
            String line = "1	17677	rs1211019702	C	T	203.48	PASS	AC=1;AN=30884;AF=3.23792e-05;rf_tp_probability=0.775352;FS=0;InbreedingCoeff=0.0001;MQ=39.17;MQRankSum=0.549;QD=6.56;ReadPosRankSum=0.771;SOR=0.017;BaseQRankSum=-1.735;ClippingRankSum=0.223;DP=661391;VQSLOD=-24.26;VQSR_culprit=MQ;segdup;variant_type=snv;allele_type=snv;n_alt_alleles=1;pab_max=0.281042;gq_hist_alt_bin_freq=0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|0|1;gq_hist_all_bin_freq=10|29|37|93|162|102|339|372|272|578|751|427|1499|451|1170|589|1620|276|1481|10043;dp_hist_alt_bin_freq=0|0|0|0|0|0|1|0|0|0|0|0|0|0|0|0|0|0|0|0;dp_hist_alt_n_larger=0;dp_hist_all_bin_freq=68|303|845|1549|2758|2735|3307|3925|2225|1172|561|315|206|105|57|45|30|22|26|10;dp_hist_all_n_larger=50;ab_hist_alt_bin_freq=0|0|0|0|0|0|0|1|0|0|0|0|0|0|0|0|0|0|0|0;AC_nfe_seu=0;AN_nfe_seu=72;AF_nfe_seu=0;nhomalt_nfe_seu=0;controls_AC_afr_male=0;controls_AN_afr_male=1376;controls_AF_afr_male=0;controls_nhomalt_afr_male=0;non_topmed_AC_amr=0;non_topmed_AN_amr=792;non_topmed_AF_amr=0;non_topmed_nhomalt_amr=0;AC_raw=1;AN_raw=31416;AF_raw=3.18309e-05;nhomalt_raw=0;AC_fin_female=0;AN_fin_female=1842;AF_fin_female=0;nhomalt_fin_female=0;non_neuro_AC_asj_female=0;non_neuro_AN_asj_female=54;non_neuro_AF_asj_female=0;non_neuro_nhomalt_asj_female=0;non_neuro_AC_afr_male=0;non_neuro_AN_afr_male=1570;non_neuro_AF_afr_male=0;non_neuro_nhomalt_afr_male=0;AC_afr_male=0;AN_afr_male=4942;AF_afr_male=0;nhomalt_afr_male=0;AC_afr=0;AN_afr=8586;AF_afr=0;nhomalt_afr=0;non_neuro_AC_afr_female=0;non_neuro_AN_afr_female=1754;non_neuro_AF_afr_female=0;non_neuro_nhomalt_afr_female=0;non_topmed_AC_amr_female=0;non_topmed_AN_amr_female=388;non_topmed_AF_amr_female=0;non_topmed_nhomalt_amr_female=0;non_topmed_AC_oth_female=0;non_topmed_AN_oth_female=536;non_topmed_AF_oth_female=0;non_topmed_nhomalt_oth_female=0;AC_eas_female=0;AN_eas_female=518;AF_eas_female=0;nhomalt_eas_female=0;AC_afr_female=0;AN_afr_female=3644;AF_afr_female=0;nhomalt_afr_female=0;non_neuro_AC_female=0;non_neuro_AN_female=9454;non_neuro_AF_female=0;non_neuro_nhomalt_female=0;controls_AC_afr=0;controls_AN_afr=2530;controls_AF_afr=0;controls_nhomalt_afr=0;AC_nfe_onf=0;AN_nfe_onf=2058;AF_nfe_onf=0;nhomalt_nfe_onf=0;controls_AC_fin_male=0;controls_AN_fin_male=604;controls_AF_fin_male=0;controls_nhomalt_fin_male=0;non_neuro_AC_nfe_nwe=0;non_neuro_AN_nfe_nwe=7644;non_neuro_AF_nfe_nwe=0;non_neuro_nhomalt_nfe_nwe=0;AC_fin_male=0;AN_fin_male=1628;AF_fin_male=0;nhomalt_fin_male=0;AC_nfe_female=0;AN_nfe_female=6690;AF_nfe_female=0;nhomalt_nfe_female=0;AC_amr=0;AN_amr=830;AF_amr=0;nhomalt_amr=0;non_topmed_AC_nfe_male=1;non_topmed_AN_nfe_male=5308;non_topmed_AF_nfe_male=0.000188395;non_topmed_nhomalt_nfe_male=0;AC_eas=0;AN_eas=1522;AF_eas=0;nhomalt_eas=0;nhomalt=0;non_neuro_AC_nfe_female=0;non_neuro_AN_nfe_female=5906;non_neuro_AF_nfe_female=0;non_neuro_nhomalt_nfe_female=0;non_neuro_AC_afr=0;non_neuro_AN_afr=3324;non_neuro_AF_afr=0;non_neuro_nhomalt_afr=0;controls_AC_raw=1;controls_AN_raw=10884;controls_AF_raw=9.1878e-05;controls_nhomalt_raw=0;controls_AC_male=1;controls_AN_male=5730;controls_AF_male=0.00017452;controls_nhomalt_male=0;non_topmed_AC_male=1;non_topmed_AN_male=13698;non_topmed_AF_male=7.30034e-05;non_topmed_nhomalt_male=0;controls_AC_nfe_female=0;controls_AN_nfe_female=2514;controls_AF_nfe_female=0;controls_nhomalt_nfe_female=0;non_neuro_AC_amr=0;non_neuro_AN_amr=548;non_neuro_AF_amr=0;non_neuro_nhomalt_amr=0;non_neuro_AC_eas_female=0;non_neuro_AN_eas_female=518;non_neuro_AF_eas_female=0;non_neuro_nhomalt_eas_female=0;AC_asj_male=0;AN_asj_male=206;AF_asj_male=0;nhomalt_asj_male=0;controls_AC_nfe_male=1;controls_AN_nfe_male=2856;controls_AF_nfe_male=0.00035014;controls_nhomalt_nfe_male=0;non_neuro_AC_fin=0;non_neuro_AN_fin=1162;non_neuro_AF_fin=0;non_neuro_nhomalt_fin=0;AC_oth_female=0;AN_oth_female=552;AF_oth_female=0;nhomalt_oth_female=0;controls_AC_nfe=1;controls_AN_nfe=5370;controls_AF_nfe=0.00018622;controls_nhomalt_nfe=0;controls_AC_oth_female=0;controls_AN_oth_female=222;controls_AF_oth_female=0;controls_nhomalt_oth_female=0;controls_AC_asj=0;controls_AN_asj=32;controls_AF_asj=0;controls_nhomalt_asj=0;non_neuro_AC_amr_male=0;non_neuro_AN_amr_male=242;non_neuro_AF_amr_male=0;non_neuro_nhomalt_amr_male=0;controls_AC_nfe_nwe=0;controls_AN_nfe_nwe=884;controls_AF_nfe_nwe=0;controls_nhomalt_nfe_nwe=0;AC_nfe_nwe=0;AN_nfe_nwe=8462;AF_nfe_nwe=0;nhomalt_nfe_nwe=0;controls_AC_nfe_seu=0;controls_AN_nfe_seu=34;controls_AF_nfe_seu=0;controls_nhomalt_nfe_seu=0;non_neuro_AC_amr_female=0;non_neuro_AN_amr_female=306;non_neuro_AF_amr_female=0;non_neuro_nhomalt_amr_female=0;non_neuro_AC_nfe_onf=0;non_neuro_AN_nfe_onf=1676;non_neuro_AF_nfe_onf=0;non_neuro_nhomalt_nfe_onf=0;non_topmed_AC_eas_male=0;non_topmed_AN_eas_male=986;non_topmed_AF_eas_male=0;non_topmed_nhomalt_eas_male=0;controls_AC_amr_female=0;controls_AN_amr_female=120;controls_AF_amr_female=0;controls_nhomalt_amr_female=0;non_neuro_AC_fin_male=0;non_neuro_AN_fin_male=604;non_neuro_AF_fin_male=0;non_neuro_nhomalt_fin_male=0;AC_female=0;AN_female=13726;AF_female=0;nhomalt_female=0;non_neuro_AC_oth_male=0;non_neuro_AN_oth_male=366;non_neuro_AF_oth_male=0;non_neuro_nhomalt_oth_male=0;non_topmed_AC_nfe_est=1;non_topmed_AN_nfe_est=4522;non_topmed_AF_nfe_est=0.000221141;non_topmed_nhomalt_nfe_est=0;non_topmed_AC_nfe_nwe=0;non_topmed_AN_nfe_nwe=4778;non_topmed_AF_nfe_nwe=0;non_topmed_nhomalt_nfe_nwe=0;non_topmed_AC_amr_male=0;non_topmed_AN_amr_male=404;non_topmed_AF_amr_male=0;non_topmed_nhomalt_amr_male=0;non_topmed_AC_nfe_onf=0;non_topmed_AN_nfe_onf=1436;non_topmed_AF_nfe_onf=0;non_topmed_nhomalt_nfe_onf=0;controls_AC_eas_male=0;controls_AN_eas_male=560;controls_AF_eas_male=0;controls_nhomalt_eas_male=0;controls_AC_oth_male=0;controls_AN_oth_male=194;controls_AF_oth_male=0;controls_nhomalt_oth_male=0;non_topmed_AC=1;non_topmed_AN=26096;non_topmed_AF=3.832e-05;non_topmed_nhomalt=0;controls_AC_fin=0;controls_AN_fin=1160;controls_AF_fin=0;controls_nhomalt_fin=0;non_neuro_AC_nfe=1;non_neuro_AN_nfe=13450;non_neuro_AF_nfe=7.43494e-05;non_neuro_nhomalt_nfe=0;non_neuro_AC_fin_female=0;non_neuro_AN_fin_female=558;non_neuro_AF_fin_female=0;non_neuro_nhomalt_fin_female=0;non_topmed_AC_nfe_seu=0;non_topmed_AN_nfe_seu=72;non_topmed_AF_nfe_seu=0;non_topmed_nhomalt_nfe_seu=0;controls_AC_eas_female=0;controls_AN_eas_female=332;controls_AF_eas_female=0;controls_nhomalt_eas_female=0;non_topmed_AC_asj=0;non_topmed_AN_asj=126;non_topmed_AF_asj=0;non_topmed_nhomalt_asj=0;controls_AC_nfe_onf=0;controls_AN_nfe_onf=396;controls_AF_nfe_onf=0;controls_nhomalt_nfe_onf=0;non_neuro_AC=1;non_neuro_AN=20970;non_neuro_AF=4.76872e-05;non_neuro_nhomalt=0;non_topmed_AC_nfe=1;non_topmed_AN_nfe=10808;non_topmed_AF_nfe=9.25241e-05;non_topmed_nhomalt_nfe=0;non_topmed_AC_raw=1;non_topmed_AN_raw=26608;non_topmed_AF_raw=3.75827e-05;non_topmed_nhomalt_raw=0;non_neuro_AC_nfe_est=1;non_neuro_AN_nfe_est=4098;non_neuro_AF_nfe_est=0.000244021;non_neuro_nhomalt_nfe_est=0;non_topmed_AC_oth_male=0;non_topmed_AN_oth_male=450;non_topmed_AF_oth_male=0;non_topmed_nhomalt_oth_male=0;AC_nfe_est=1;AN_nfe_est=4544;AF_nfe_est=0.00022007;nhomalt_nfe_est=0;non_topmed_AC_afr_male=0;non_topmed_AN_afr_male=4850;non_topmed_AF_afr_male=0;non_topmed_nhomalt_afr_male=0;AC_eas_male=0;AN_eas_male=1004;AF_eas_male=0;nhomalt_eas_male=0;controls_AC_eas=0;controls_AN_eas=892;controls_AF_eas=0;controls_nhomalt_eas=0;non_neuro_AC_eas_male=0;non_neuro_AN_eas_male=1004;non_neuro_AF_eas_male=0;non_neuro_nhomalt_eas_male=0;non_neuro_AC_asj_male=0;non_neuro_AN_asj_male=186;non_neuro_AF_asj_male=0;non_neuro_nhomalt_asj_male=0;controls_AC_oth=0;controls_AN_oth=416;controls_AF_oth=0;controls_nhomalt_oth=0;AC_nfe=1;AN_nfe=15136;AF_nfe=6.60677e-05;nhomalt_nfe=1;non_topmed_AC_female=0;non_topmed_AN_female=12398;non_topmed_AF_female=0;non_topmed_nhomalt_female=0;non_neuro_AC_asj=0;non_neuro_AN_asj=240;non_neuro_AF_asj=0;non_neuro_nhomalt_asj=0;non_topmed_AC_eas_female=0;non_topmed_AN_eas_female=502;non_topmed_AF_eas_female=0;non_topmed_nhomalt_eas_female=0;non_neuro_AC_raw=1;non_neuro_AN_raw=21272;non_neuro_AF_raw=4.70102e-05;non_neuro_nhomalt_raw=0;non_topmed_AC_eas=0;non_topmed_AN_eas=1488;non_topmed_AF_eas=0;non_topmed_nhomalt_eas=0;non_topmed_AC_fin_male=0;non_topmed_AN_fin_male=1628;non_topmed_AF_fin_male=0;non_topmed_nhomalt_fin_male=0;AC_fin=0;AN_fin=3470;AF_fin=0;nhomalt_fin=0;AC_nfe_male=1;AN_nfe_male=8446;AF_nfe_male=0.000118399;nhomalt_nfe_male=0;controls_AC_amr_male=0;controls_AN_amr_male=126;controls_AF_amr_male=0;controls_nhomalt_amr_male=0;controls_AC_afr_female=0;controls_AN_afr_female=1154;controls_AF_afr_female=0;controls_nhomalt_afr_female=0;controls_AC_amr=0;controls_AN_amr=246;controls_AF_amr=0;controls_nhomalt_amr=0;AC_asj_female=0;AN_asj_female=72;AF_asj_female=0;nhomalt_asj_female=0;non_neuro_AC_eas=0;non_neuro_AN_eas=1522;non_neuro_AF_eas=0;non_neuro_nhomalt_eas=0;non_neuro_AC_male=1;non_neuro_AN_male=11516;non_neuro_AF_male=8.68357e-05;non_neuro_nhomalt_male=0;AC_asj=0;AN_asj=278;AF_asj=0;nhomalt_asj=0;controls_AC_nfe_est=1;controls_AN_nfe_est=4056;controls_AF_nfe_est=0.000246548;controls_nhomalt_nfe_est=0;non_topmed_AC_asj_female=0;non_topmed_AN_asj_female=54;non_topmed_AF_asj_female=0;non_topmed_nhomalt_asj_female=0;non_topmed_AC_oth=0;non_topmed_AN_oth=986;non_topmed_AF_oth=0;non_topmed_nhomalt_oth=0;non_topmed_AC_fin_female=0;non_topmed_AN_fin_female=1842;non_topmed_AF_fin_female=0;non_topmed_nhomalt_fin_female=0;AC_oth=0;AN_oth=1062;AF_oth=0;nhomalt_oth=0;non_neuro_AC_nfe_male=1;non_neuro_AN_nfe_male=7544;non_neuro_AF_nfe_male=0.000132556;non_neuro_nhomalt_nfe_male=0;controls_AC_female=0;controls_AN_female=4916;controls_AF_female=0;controls_nhomalt_female=0;non_topmed_AC_fin=0;non_topmed_AN_fin=3470;non_topmed_AF_fin=0;non_topmed_nhomalt_fin=0;non_topmed_AC_nfe_female=0;non_topmed_AN_nfe_female=5500;non_topmed_AF_nfe_female=0;non_topmed_nhomalt_nfe_female=0;controls_AC_asj_male=0;controls_AN_asj_male=14;controls_AF_asj_male=0;controls_nhomalt_asj_male=0;non_topmed_AC_asj_male=0;non_topmed_AN_asj_male=72;non_topmed_AF_asj_male=0;non_topmed_nhomalt_asj_male=0;non_neuro_AC_oth=0;non_neuro_AN_oth=724;non_neuro_AF_oth=0;non_neuro_nhomalt_oth=0;AC_male=1;AN_male=17158;AF_male=5.82819e-05;nhomalt_male=0;controls_AC_fin_female=0;controls_AN_fin_female=556;controls_AF_fin_female=0;controls_nhomalt_fin_female=0;controls_AC_asj_female=0;controls_AN_asj_female=18;controls_AF_asj_female=0;controls_nhomalt_asj_female=0;AC_amr_male=0;AN_amr_male=422;AF_amr_male=0;nhomalt_amr_male=0;AC_amr_female=0;AN_amr_female=408;AF_amr_female=0;nhomalt_amr_female=0;AC_oth_male=0;AN_oth_male=510;AF_oth_male=0;nhomalt_oth_male=0;non_neuro_AC_nfe_seu=0;non_neuro_AN_nfe_seu=32;non_neuro_AF_nfe_seu=0;non_neuro_nhomalt_nfe_seu=0;non_topmed_AC_afr_female=0;non_topmed_AN_afr_female=3576;non_topmed_AF_afr_female=0;non_topmed_nhomalt_afr_female=0;non_topmed_AC_afr=0;non_topmed_AN_afr=8426;non_topmed_AF_afr=0;non_topmed_nhomalt_afr=0;controls_AC=1;controls_AN=10646;controls_AF=9.3932e-05;controls_nhomalt=0;non_neuro_AC_oth_female=0;non_neuro_AN_oth_female=358;non_neuro_AF_oth_female=0;non_neuro_nhomalt_oth_female=0;non_topmed_faf95_amr=0;non_topmed_faf99_amr=0;faf95_afr=0;faf99_afr=0;controls_faf95_afr=0;controls_faf99_afr=0;faf95_amr=0;faf99_amr=0;faf95_eas=0;faf99_eas=0;faf95=1e-06;faf99=1e-06;non_neuro_faf95_afr=0;non_neuro_faf99_afr=0;non_neuro_faf95_amr=0;non_neuro_faf99_amr=0;controls_faf95_nfe=9e-06;controls_faf99_nfe=9e-06;non_topmed_faf95=1e-06;non_topmed_faf99=1e-06;non_neuro_faf95_nfe=3e-06;non_neuro_faf99_nfe=3e-06;non_neuro_faf95=2e-06;non_neuro_faf99=2e-06;non_topmed_faf95_nfe=4e-06;non_topmed_faf99_nfe=4e-06;controls_faf95_eas=0;controls_faf99_eas=0;faf95_nfe=3e-06;faf99_nfe=3e-06;non_topmed_faf95_eas=0;non_topmed_faf99_eas=0;controls_faf95_amr=0;controls_faf99_amr=0;non_neuro_faf95_eas=0;non_neuro_faf99_eas=0;non_topmed_faf95_afr=0;non_topmed_faf99_afr=0;controls_faf95=4e-06;controls_faf99=4e-06;controls_popmax=nfe;controls_AC_popmax=1;controls_AN_popmax=5370;controls_AF_popmax=0.00018622;controls_nhomalt_popmax=0;popmax=nfe;AC_popmax=1;AN_popmax=15136;AF_popmax=6.60677e-05;nhomalt_popmax=0;age_hist_het_bin_freq=0|0|0|0|0|0|0|1|0|0;age_hist_het_n_smaller=0;age_hist_het_n_larger=0;age_hist_hom_bin_freq=0|0|0|0|0|0|0|0|0|0;age_hist_hom_n_smaller=0;age_hist_hom_n_larger=0;non_neuro_popmax=nfe;non_neuro_AC_popmax=1;non_neuro_AN_popmax=13450;non_neuro_AF_popmax=7.43494e-05;non_neuro_nhomalt_popmax=0;non_topmed_popmax=nfe;non_topmed_AC_popmax=1;non_topmed_AN_popmax=10808;non_topmed_AF_popmax=9.25241e-05;non_topmed_nhomalt_popmax=0";

            Allele expected = new Allele(1, 17677, "C", "T");
            expected.setRsId("rs1211019702");
            expected.addFrequency(AlleleData.frequencyOf(GNOMAD_E_NFE, 1, 15136, 1));
            assertParseResultsEquals(parseLine(line), List.of(expected));
        }
    }
}